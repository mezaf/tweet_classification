CREATE EXTERNAL TABLE `customer_twitter_cooked`(
  `created_at` string COMMENT 'from deserializer', 
  `id` bigint COMMENT 'from deserializer', 
  `id_str` string COMMENT 'from deserializer', 
  `text` string COMMENT 'from deserializer', 
  `source` string COMMENT 'from deserializer', 
  `truncated` boolean COMMENT 'from deserializer', 
  `in_reply_to_status_id` bigint COMMENT 'from deserializer', 
  `in_reply_to_status_id_str` string COMMENT 'from deserializer', 
  `in_reply_to_user_id` bigint COMMENT 'from deserializer', 
  `in_reply_to_user_id_str` string COMMENT 'from deserializer', 
  `in_reply_to_screen_name` string COMMENT 'from deserializer', 
  `user` struct<id:bigint,id_str:string,name:string,screen_name:string,location:string,url:string,description:string,translator_type:string,protected:boolean,verified:boolean,followers_count:int,friends_count:int,listed_count:int,favourites_count:int,statuses_count:int,created_at:string,utc_offset:string,time_zone:string,geo_enabled:boolean,lang:string,contributors_enabled:boolean,is_translator:boolean,profile_background_color:string,profile_background_image_url:string,profile_background_image_url_https:string,profile_background_tile:boolean,profile_link_color:string,profile_sidebar_border_color:string,profile_sidebar_fill_color:string,profile_text_color:string,profile_use_background_image:boolean,profile_image_url:string,profile_image_url_https:string,profile_banner_url:string,default_profile:boolean,default_profile_image:boolean,`following`:string,follow_request_sent:string,notifications:string> COMMENT 'from deserializer', 
  `geo` struct<type:string,coordinates:array<double>> COMMENT 'from deserializer', 
  `coordinates` struct<type:string,coordinates:array<double>> COMMENT 'from deserializer', 
  `place` struct<id:string,url:string,place_type:string,name:string,full_name:string,country_code:string,country:string,bounding_box:struct<type:string,coordinates:array<array<array<double>>>>,attributes:string> COMMENT 'from deserializer', 
  `contributors` string COMMENT 'from deserializer', 
  `is_quote_status` boolean COMMENT 'from deserializer', 
  `extended_tweet` struct<full_text:string,display_text_range:array<int>,entities:struct<hashtags:array<struct<text:string,indices:array<int>>>,urls:array<struct<url:string,expanded_url:string,display_url:string,indices:array<int>>>,user_mentions:array<struct<screen_name:string,name:string,id:bigint,id_str:string,indices:array<int>>>,symbols:array<struct<text:string,indices:array<int>>>,media:array<struct<id:bigint,id_str:string,indices:array<int>,media_url:string,media_url_https:string,url:string,display_url:string,expanded_url:string,type:string,sizes:struct<thumb:struct<w:int,h:int,resize:string>,large:struct<w:int,h:int,resize:string>,small:struct<w:int,h:int,resize:string>,medium:struct<w:int,h:int,resize:string>>,source_status_id:bigint,source_status_id_str:string,source_user_id:bigint,source_user_id_str:string,additional_media_info:struct<monetizable:boolean,title:string,description:string,embeddable:boolean>,video_info:struct<aspect_ratio:array<int>,duration_millis:int,variants:array<struct<content_type:string,url:string,bitrate:int>>>,description:string>>>,extended_entities:struct<media:array<struct<id:bigint,id_str:string,indices:array<int>,media_url:string,media_url_https:string,url:string,display_url:string,expanded_url:string,type:string,sizes:struct<thumb:struct<w:int,h:int,resize:string>,large:struct<w:int,h:int,resize:string>,small:struct<w:int,h:int,resize:string>,medium:struct<w:int,h:int,resize:string>>,source_status_id:bigint,source_status_id_str:string,source_user_id:bigint,source_user_id_str:string,additional_media_info:struct<monetizable:boolean,title:string,description:string,embeddable:boolean>,video_info:struct<aspect_ratio:array<int>,duration_millis:int,variants:array<struct<content_type:string,url:string,bitrate:int>>>,description:string>>>> COMMENT 'from deserializer', 
  `quote_count` int COMMENT 'from deserializer', 
  `reply_count` int COMMENT 'from deserializer', 
  `retweet_count` int COMMENT 'from deserializer', 
  `favorite_count` int COMMENT 'from deserializer', 
  `entities` struct<hashtags:array<struct<text:string,indices:array<int>>>,urls:array<struct<url:string,expanded_url:string,display_url:string,indices:array<int>>>,user_mentions:array<struct<screen_name:string,name:string,id:bigint,id_str:string,indices:array<int>>>,symbols:array<struct<text:string,indices:array<int>>>,media:array<struct<id:bigint,id_str:string,indices:array<int>,media_url:string,media_url_https:string,url:string,display_url:string,expanded_url:string,type:string,sizes:struct<thumb:struct<w:int,h:int,resize:string>,large:struct<w:int,h:int,resize:string>,small:struct<w:int,h:int,resize:string>,medium:struct<w:int,h:int,resize:string>>,source_status_id:bigint,source_status_id_str:string,source_user_id:bigint,source_user_id_str:string,description:string,additional_media_info:struct<monetizable:boolean,title:string,description:string,embeddable:boolean>>>> COMMENT 'from deserializer', 
  `favorited` boolean COMMENT 'from deserializer', 
  `retweeted` boolean COMMENT 'from deserializer', 
  `filter_level` string COMMENT 'from deserializer', 
  `lang` string COMMENT 'from deserializer', 
  `timestamp_ms` string COMMENT 'from deserializer', 
  `retweeted_status` struct<created_at:string,id:bigint,id_str:string,text:string,source:string,truncated:boolean,in_reply_to_status_id:bigint,in_reply_to_status_id_str:string,in_reply_to_user_id:bigint,in_reply_to_user_id_str:string,in_reply_to_screen_name:string,user:struct<id:bigint,id_str:string,name:string,screen_name:string,location:string,url:string,description:string,translator_type:string,protected:boolean,verified:boolean,followers_count:int,friends_count:int,listed_count:int,favourites_count:int,statuses_count:int,created_at:string,utc_offset:string,time_zone:string,geo_enabled:boolean,lang:string,contributors_enabled:boolean,is_translator:boolean,profile_background_color:string,profile_background_image_url:string,profile_background_image_url_https:string,profile_background_tile:boolean,profile_link_color:string,profile_sidebar_border_color:string,profile_sidebar_fill_color:string,profile_text_color:string,profile_use_background_image:boolean,profile_image_url:string,profile_image_url_https:string,profile_banner_url:string,default_profile:boolean,default_profile_image:boolean,`following`:string,follow_request_sent:string,notifications:string>,geo:struct<type:string,coordinates:array<double>>,coordinates:struct<type:string,coordinates:array<double>>,place:struct<id:string,url:string,place_type:string,name:string,full_name:string,country_code:string,country:string,bounding_box:struct<type:string,coordinates:array<array<array<double>>>>,attributes:string>,contributors:string,is_quote_status:boolean,quote_count:int,reply_count:int,retweet_count:int,favorite_count:int,entities:struct<hashtags:array<struct<text:string,indices:array<int>>>,urls:array<struct<url:string,expanded_url:string,display_url:string,indices:array<int>>>,user_mentions:array<struct<screen_name:string,name:string,id:bigint,id_str:string,indices:array<int>>>,symbols:array<struct<text:string,indices:array<int>>>,media:array<struct<id:bigint,id_str:string,indices:array<int>,media_url:string,media_url_https:string,url:string,display_url:string,expanded_url:string,type:string,sizes:struct<thumb:struct<w:int,h:int,resize:string>,medium:struct<w:int,h:int,resize:string>,large:struct<w:int,h:int,resize:string>,small:struct<w:int,h:int,resize:string>>,description:string,additional_media_info:struct<monetizable:boolean,title:string,description:string,embeddable:boolean>,source_status_id:bigint,source_status_id_str:string,source_user_id:bigint,source_user_id_str:string>>>,favorited:boolean,retweeted:boolean,possibly_sensitive:boolean,filter_level:string,lang:string,quoted_status_id:bigint,quoted_status_id_str:string,quoted_status:struct<created_at:string,id:bigint,id_str:string,text:string,display_text_range:array<int>,source:string,truncated:boolean,in_reply_to_status_id:bigint,in_reply_to_status_id_str:string,in_reply_to_user_id:bigint,in_reply_to_user_id_str:string,in_reply_to_screen_name:string,user:struct<id:bigint,id_str:string,name:string,screen_name:string,location:string,url:string,description:string,translator_type:string,protected:boolean,verified:boolean,followers_count:int,friends_count:int,listed_count:int,favourites_count:int,statuses_count:int,created_at:string,utc_offset:string,time_zone:string,geo_enabled:boolean,lang:string,contributors_enabled:boolean,is_translator:boolean,profile_background_color:string,profile_background_image_url:string,profile_background_image_url_https:string,profile_background_tile:boolean,profile_link_color:string,profile_sidebar_border_color:string,profile_sidebar_fill_color:string,profile_text_color:string,profile_use_background_image:boolean,profile_image_url:string,profile_image_url_https:string,profile_banner_url:string,default_profile:boolean,default_profile_image:boolean,`following`:string,follow_request_sent:string,notifications:string>,geo:string,coordinates:string,place:struct<id:string,url:string,place_type:string,name:string,full_name:string,country_code:string,country:string,bounding_box:struct<type:string,coordinates:array<array<array<double>>>>,attributes:string>,contributors:string,is_quote_status:boolean,extended_tweet:struct<full_text:string,display_text_range:array<int>,entities:struct<hashtags:array<struct<text:string,indices:array<int>>>,urls:array<struct<url:string,expanded_url:string,display_url:string,indices:array<int>>>,user_mentions:array<struct<screen_name:string,name:string,id:bigint,id_str:string,indices:array<int>>>,symbols:array<string>,media:array<struct<id:bigint,id_str:string,indices:array<int>,media_url:string,media_url_https:string,url:string,display_url:string,expanded_url:string,type:string,sizes:struct<small:struct<w:int,h:int,resize:string>,thumb:struct<w:int,h:int,resize:string>,large:struct<w:int,h:int,resize:string>,medium:struct<w:int,h:int,resize:string>>,additional_media_info:struct<monetizable:boolean,title:string,description:string,embeddable:boolean>,video_info:struct<aspect_ratio:array<int>,duration_millis:int,variants:array<struct<bitrate:int,content_type:string,url:string>>>,source_status_id:bigint,source_status_id_str:string,source_user_id:bigint,source_user_id_str:string,description:string>>>,extended_entities:struct<media:array<struct<id:bigint,id_str:string,indices:array<int>,media_url:string,media_url_https:string,url:string,display_url:string,expanded_url:string,type:string,sizes:struct<small:struct<w:int,h:int,resize:string>,thumb:struct<w:int,h:int,resize:string>,large:struct<w:int,h:int,resize:string>,medium:struct<w:int,h:int,resize:string>>,additional_media_info:struct<monetizable:boolean,title:string,description:string,embeddable:boolean>,video_info:struct<aspect_ratio:array<int>,duration_millis:int,variants:array<struct<bitrate:int,content_type:string,url:string>>>,source_status_id:bigint,source_status_id_str:string,source_user_id:bigint,source_user_id_str:string,description:string>>>>,quote_count:int,reply_count:int,retweet_count:int,favorite_count:int,entities:struct<hashtags:array<struct<text:string,indices:array<int>>>,urls:array<struct<url:string,expanded_url:string,display_url:string,indices:array<int>>>,user_mentions:array<struct<screen_name:string,name:string,id:bigint,id_str:string,indices:array<int>>>,symbols:array<string>,media:array<struct<id:bigint,id_str:string,indices:array<int>,media_url:string,media_url_https:string,url:string,display_url:string,expanded_url:string,type:string,sizes:struct<thumb:struct<w:int,h:int,resize:string>,small:struct<w:int,h:int,resize:string>,large:struct<w:int,h:int,resize:string>,medium:struct<w:int,h:int,resize:string>>,additional_media_info:struct<monetizable:boolean>,description:string>>>,favorited:boolean,retweeted:boolean,possibly_sensitive:boolean,filter_level:string,lang:string,quoted_status_id:bigint,quoted_status_id_str:string,extended_entities:struct<media:array<struct<id:bigint,id_str:string,indices:array<int>,media_url:string,media_url_https:string,url:string,display_url:string,expanded_url:string,type:string,sizes:struct<thumb:struct<w:int,h:int,resize:string>,small:struct<w:int,h:int,resize:string>,large:struct<w:int,h:int,resize:string>,medium:struct<w:int,h:int,resize:string>>,additional_media_info:struct<monetizable:boolean>,video_info:struct<aspect_ratio:array<int>,duration_millis:int,variants:array<struct<bitrate:int,content_type:string,url:string>>>,description:string>>>>,quoted_status_permalink:struct<url:string,expanded:string,display:string>,extended_tweet:struct<full_text:string,display_text_range:array<int>,entities:struct<hashtags:array<struct<text:string,indices:array<int>>>,urls:array<struct<url:string,expanded_url:string,display_url:string,indices:array<int>>>,user_mentions:array<struct<screen_name:string,name:string,id:bigint,id_str:string,indices:array<int>>>,symbols:array<struct<text:string,indices:array<int>>>,media:array<struct<id:bigint,id_str:string,indices:array<int>,media_url:string,media_url_https:string,url:string,display_url:string,expanded_url:string,type:string,sizes:struct<thumb:struct<w:int,h:int,resize:string>,large:struct<w:int,h:int,resize:string>,medium:struct<w:int,h:int,resize:string>,small:struct<w:int,h:int,resize:string>>,additional_media_info:struct<monetizable:boolean,title:string,description:string,embeddable:boolean>,video_info:struct<aspect_ratio:array<int>,duration_millis:int,variants:array<struct<content_type:string,url:string,bitrate:int>>>,source_status_id:bigint,source_status_id_str:string,source_user_id:bigint,source_user_id_str:string,description:string>>>,extended_entities:struct<media:array<struct<id:bigint,id_str:string,indices:array<int>,media_url:string,media_url_https:string,url:string,display_url:string,expanded_url:string,type:string,sizes:struct<thumb:struct<w:int,h:int,resize:string>,large:struct<w:int,h:int,resize:string>,medium:struct<w:int,h:int,resize:string>,small:struct<w:int,h:int,resize:string>>,additional_media_info:struct<monetizable:boolean,title:string,description:string,embeddable:boolean>,video_info:struct<aspect_ratio:array<int>,duration_millis:int,variants:array<struct<content_type:string,url:string,bitrate:int>>>,source_status_id:bigint,source_status_id_str:string,source_user_id:bigint,source_user_id_str:string,description:string>>>>,display_text_range:array<int>,extended_entities:struct<media:array<struct<id:bigint,id_str:string,indices:array<int>,media_url:string,media_url_https:string,url:string,display_url:string,expanded_url:string,type:string,sizes:struct<thumb:struct<w:int,h:int,resize:string>,medium:struct<w:int,h:int,resize:string>,large:struct<w:int,h:int,resize:string>,small:struct<w:int,h:int,resize:string>>,video_info:struct<aspect_ratio:array<int>,variants:array<struct<bitrate:int,content_type:string,url:string>>,duration_millis:int>,description:string,additional_media_info:struct<monetizable:boolean,title:string,description:string,embeddable:boolean>,source_status_id:bigint,source_status_id_str:string,source_user_id:bigint,source_user_id_str:string>>>,scopes:struct<followers:boolean>> COMMENT 'from deserializer', 
  `possibly_sensitive` boolean COMMENT 'from deserializer', 
  `display_text_range` array<int> COMMENT 'from deserializer', 
  `quoted_status_id` bigint COMMENT 'from deserializer', 
  `quoted_status_id_str` string COMMENT 'from deserializer', 
  `quoted_status` struct<created_at:string,id:bigint,id_str:string,text:string,display_text_range:array<int>,source:string,truncated:boolean,in_reply_to_status_id:bigint,in_reply_to_status_id_str:string,in_reply_to_user_id:bigint,in_reply_to_user_id_str:string,in_reply_to_screen_name:string,user:struct<id:bigint,id_str:string,name:string,screen_name:string,location:string,url:string,description:string,translator_type:string,protected:boolean,verified:boolean,followers_count:int,friends_count:int,listed_count:int,favourites_count:int,statuses_count:int,created_at:string,utc_offset:string,time_zone:string,geo_enabled:boolean,lang:string,contributors_enabled:boolean,is_translator:boolean,profile_background_color:string,profile_background_image_url:string,profile_background_image_url_https:string,profile_background_tile:boolean,profile_link_color:string,profile_sidebar_border_color:string,profile_sidebar_fill_color:string,profile_text_color:string,profile_use_background_image:boolean,profile_image_url:string,profile_image_url_https:string,profile_banner_url:string,default_profile:boolean,default_profile_image:boolean,`following`:string,follow_request_sent:string,notifications:string>,geo:string,coordinates:string,place:struct<id:string,url:string,place_type:string,name:string,full_name:string,country_code:string,country:string,bounding_box:struct<type:string,coordinates:array<array<array<double>>>>,attributes:string>,contributors:string,is_quote_status:boolean,extended_tweet:struct<full_text:string,display_text_range:array<int>,entities:struct<hashtags:array<struct<text:string,indices:array<int>>>,urls:array<struct<url:string,expanded_url:string,display_url:string,indices:array<int>>>,user_mentions:array<struct<screen_name:string,name:string,id:bigint,id_str:string,indices:array<int>>>,symbols:array<string>,media:array<struct<id:bigint,id_str:string,indices:array<int>,media_url:string,media_url_https:string,url:string,display_url:string,expanded_url:string,type:string,sizes:struct<small:struct<w:int,h:int,resize:string>,thumb:struct<w:int,h:int,resize:string>,large:struct<w:int,h:int,resize:string>,medium:struct<w:int,h:int,resize:string>>,additional_media_info:struct<monetizable:boolean,title:string,description:string,embeddable:boolean>,video_info:struct<aspect_ratio:array<int>,duration_millis:int,variants:array<struct<bitrate:int,content_type:string,url:string>>>,source_status_id:bigint,source_status_id_str:string,source_user_id:bigint,source_user_id_str:string,description:string>>>,extended_entities:struct<media:array<struct<id:bigint,id_str:string,indices:array<int>,media_url:string,media_url_https:string,url:string,display_url:string,expanded_url:string,type:string,sizes:struct<small:struct<w:int,h:int,resize:string>,thumb:struct<w:int,h:int,resize:string>,large:struct<w:int,h:int,resize:string>,medium:struct<w:int,h:int,resize:string>>,additional_media_info:struct<monetizable:boolean,title:string,description:string,embeddable:boolean>,video_info:struct<aspect_ratio:array<int>,duration_millis:int,variants:array<struct<bitrate:int,content_type:string,url:string>>>,source_status_id:bigint,source_status_id_str:string,source_user_id:bigint,source_user_id_str:string,description:string>>>>,quote_count:int,reply_count:int,retweet_count:int,favorite_count:int,entities:struct<hashtags:array<struct<text:string,indices:array<int>>>,urls:array<struct<url:string,expanded_url:string,display_url:string,indices:array<int>>>,user_mentions:array<struct<screen_name:string,name:string,id:bigint,id_str:string,indices:array<int>>>,symbols:array<string>,media:array<struct<id:bigint,id_str:string,indices:array<int>,media_url:string,media_url_https:string,url:string,display_url:string,expanded_url:string,type:string,sizes:struct<thumb:struct<w:int,h:int,resize:string>,small:struct<w:int,h:int,resize:string>,large:struct<w:int,h:int,resize:string>,medium:struct<w:int,h:int,resize:string>>,additional_media_info:struct<monetizable:boolean,title:string,description:string,embeddable:boolean>,source_status_id:bigint,source_status_id_str:string,source_user_id:bigint,source_user_id_str:string,description:string>>>,favorited:boolean,retweeted:boolean,possibly_sensitive:boolean,filter_level:string,lang:string,quoted_status_id:bigint,quoted_status_id_str:string,extended_entities:struct<media:array<struct<id:bigint,id_str:string,indices:array<int>,media_url:string,media_url_https:string,url:string,display_url:string,expanded_url:string,type:string,sizes:struct<thumb:struct<w:int,h:int,resize:string>,small:struct<w:int,h:int,resize:string>,large:struct<w:int,h:int,resize:string>,medium:struct<w:int,h:int,resize:string>>,additional_media_info:struct<monetizable:boolean,title:string,description:string,embeddable:boolean>,video_info:struct<aspect_ratio:array<int>,duration_millis:int,variants:array<struct<bitrate:int,content_type:string,url:string>>>,source_status_id:bigint,source_status_id_str:string,source_user_id:bigint,source_user_id_str:string,description:string>>>,scopes:struct<followers:boolean>> COMMENT 'from deserializer', 
  `quoted_status_permalink` struct<url:string,expanded:string,display:string> COMMENT 'from deserializer', 
  `extended_entities` struct<media:array<struct<id:bigint,id_str:string,indices:array<int>,media_url:string,media_url_https:string,url:string,display_url:string,expanded_url:string,type:string,sizes:struct<thumb:struct<w:int,h:int,resize:string>,large:struct<w:int,h:int,resize:string>,small:struct<w:int,h:int,resize:string>,medium:struct<w:int,h:int,resize:string>>,source_status_id:bigint,source_status_id_str:string,source_user_id:bigint,source_user_id_str:string,description:string,video_info:struct<aspect_ratio:array<int>,variants:array<struct<bitrate:int,content_type:string,url:string>>,duration_millis:int>,additional_media_info:struct<monetizable:boolean,title:string,description:string,embeddable:boolean>>>> COMMENT 'from deserializer',
  `relatedcompany` string
)
PARTITIONED BY ( 
  `ymd` string,
  `company` string)
ROW FORMAT SERDE 
  'org.openx.data.jsonserde.JsonSerDe' 
WITH SERDEPROPERTIES ( 
  'paths'='contributors,coordinates,created_at,display_text_range,entities,extended_entities,extended_tweet,favorite_count,favorited,filter_level,geo,id,id_str,in_reply_to_screen_name,in_reply_to_status_id,in_reply_to_status_id_str,in_reply_to_user_id,in_reply_to_user_id_str,is_quote_status,lang,place,possibly_sensitive,quote_count,quoted_status,quoted_status_id,quoted_status_id_str,quoted_status_permalink,reply_count,retweet_count,retweeted,retweeted_status,source,text,timestamp_ms,truncated,user') 
STORED AS INPUTFORMAT 
  'org.apache.hadoop.mapred.TextInputFormat' 
OUTPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
  's3://customer-twitter-cooked/data/'